From 895511c5b3737a77f3a39ebb4374296bd998ba1a Mon Sep 17 00:00:00 2001
From: Andrew Morton <akpm@linux-foundation.org>
Date: Mon, 13 Mar 2023 10:37:16 -0700
Subject: [PATCH 2/5] mm-add-new-api-to-enable-ksm-per-process-fix

fix build, per Johannes

Link: https://lkml.kernel.org/r/20230313162603.GA965640@cmpxchg.org
Cc: Bagas Sanjaya <bagasdotme@gmail.com>
Cc: David Hildenbrand <david@redhat.com>
Cc: Johannes Weiner <hannes@cmpxchg.org>
Cc: Michal Hocko <mhocko@suse.com>
Cc: Rik van Riel <riel@surriel.com>
Cc: Stefan Roesch <shr@devkernel.io>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
---
 mm/ksm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/mm/ksm.c b/mm/ksm.c
index 6a168b454..63402da57 100644
--- a/mm/ksm.c
+++ b/mm/ksm.c
@@ -526,11 +526,11 @@ static bool vma_ksm_compatible(struct vm_area_struct *vma)
 		return false;
 
 #ifdef VM_SAO
-	if (*vm_flags & VM_SAO)
+	if (vma->vm_flags & VM_SAO)
 		return false;
 #endif
 #ifdef VM_SPARC_ADI
-	if (*vm_flags & VM_SPARC_ADI)
+	if (vma->vm_flags & VM_SPARC_ADI)
 		return false;
 #endif
 
-- 
2.40.0.71.g950264636c


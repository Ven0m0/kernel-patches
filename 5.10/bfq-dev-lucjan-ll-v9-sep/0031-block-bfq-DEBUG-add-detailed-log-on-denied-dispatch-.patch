From c4b4cf5c32804e3180042546f6a67679c170d75f Mon Sep 17 00:00:00 2001
From: Paolo Valente <paolo.valente@linaro.org>
Date: Fri, 8 May 2020 09:47:20 +0200
Subject: [PATCH 31/55] block, bfq, DEBUG: add detailed log on denied dispatch
 for I/O plugging

Signed-off-by: Paolo Valente <paolo.valente@linaro.org>
---
 block/bfq-iosched.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/block/bfq-iosched.c b/block/bfq-iosched.c
index e61c20a95..082bec8cf 100644
--- a/block/bfq-iosched.c
+++ b/block/bfq-iosched.c
@@ -5179,6 +5179,8 @@ static struct bfq_queue *bfq_select_queue(struct bfq_data *bfqd)
 					bfq_get_first_task_pid(new_bfqq));
 			bfqq = new_bfqq;
 		} else {
+			bfq_log_bfqq(bfqd, bfqq, "idling with %d busy queues",
+				     bfq_tot_busy_queues(bfqd));
 			bfqq = NULL;
 		}
 		goto keep_queue;
-- 
2.30.0.155.g66e871b664

